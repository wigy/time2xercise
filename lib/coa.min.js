/* Chronicles of Angular v0.5.3
 * Copyright (c) 2016 Tommi Ronkainen
 */
function d(a,b,c){function e(a){var b,c="";if(a instanceof Array){for(c+="[",b=0;b<a.length;b++)b&&(c+=", "),c+=e(a[b]);c+="]"}else if(a instanceof Object&&!a.__class){c+="{";var d=Object.getOwnPropertyNames(a).sort();for(b=0;b<d.length;b++)b&&(c+=","),c+=d[b]+": ",c+=e(a[d[b]]);c+="}"}else c+=a;return c}var f=Array.prototype.slice.call(arguments);if(0!==f.length){for(var g="",h=0;h<f.length;h++)h&&(g+=" "),g+=e(f[h]);if(d.messages.push(g),!d.silenced){var i=new Error("Stack trace"),j=i.stack.split("\n");if(j.splice(0,2),d.stack){console.log.apply(console,f);for(var k=0;k<j.length;k++)console.log("%c"+j[k],"color: red; display: none")}else{var l=/\((.*)\)/.exec(j[0]);l?console.log("%c"+l[1],"color: red"):console.log("%c"+j[0],"color: red"),console.log.apply(console,f)}}return f[f.length-1]}}d.silenced=!1,d.stack=!1,d.messages=[],d.quiet=function(){d.messages=[],d.silenced=!0},d.errors=function(){var a=d.messages;return d.messages=[],d.silenced=!1,a},Object.defineProperty(String.prototype,"ucfirst",{value:function(a){var b=this.toString();return b.length&&(b=b[0].toUpperCase()+b.substr(1)),b}}),Object.defineProperty(String.prototype,"code2human",{value:function(a){var b=this.split("_");return b.map(function(a){return a.ucfirst()}).join(" ")}}),angular.module("coa.audio",[]),angular.module("coa.auth",["coa.data"]),angular.module("coa.core",[]),angular.module("coa.data",["coa.core"]),angular.module("coa.datetime",["coa.data"]),angular.module("coa.input",[]),function(){function a(a){angular.forEach(a,function(a,b){f[b]=new Audio(a)})}function b(a){return"list"===a?Object.keys(f):a in f?void f[a].play():void d("Invalid audio name:",a)}function c(){return Object.keys(f)}var e=angular.module("coa.audio"),f={};e.service("player",[function(){return{load:a,list:c,play:b}}])}(),function(){var a,b=angular.module("coa.auth");b.factory("User",["Data","TypeStr",function(b,c){return a?a:(a=function(a){this.init(a)},a.prototype=new b([{name:new c({required:!0})}]),a.prototype.__class="coa.auth.User",a)}])}(),function(){var a,b=angular.module("coa.core");b.factory("Class",[function(){return a?a:(a=function(){},a.prototype={},a.prototype.__class="coa.core.Class",a.prototype.toString=function(){for(var b="",c=Object.getOwnPropertyNames(this).sort(),d=!1,e=0;e<c.length;e++)if("_"!==c[e][0]&&"$"!==c[e][0]){var f=c[e]+": ",g=this[c[e]];if(g&&g.__class)f+=g.toString();else{if("function"==typeof g)continue;if(g instanceof Array){f+="[";for(var h=0;h<g.length;h++)h&&(f+=", "),f+=g[h]instanceof a?g[h].toString():JSON.stringify(g[h]);f+="]"}else f+=JSON.stringify(g)}d&&(b+=", "),b+=f,d=!0}return this.__class?(b&&(b="{"+b+"}"),this.__class.split(".").pop()+"("+b+")"):"{"+b+"}"},a)}])}(),function(){var a,b=angular.module("coa.core");b.factory("Option",["Class",function(b){return a?a:(a=function(a){this.init(a)},a.prototype=new b,a.prototype.__class="coa.core.Option",a.prototype.init=function(a){a=a||{},this.text=void 0===a.text?null:a.text,this.type=void 0===a.type?function(){return!0}:a.type,this["default"]=void 0===a["default"]?null:a["default"],this.required=void 0===a.required?!1:a.required,this.op=void 0===a.op?function(){return null}:a.op},a.prototype.operate=function(a,b){return void 0===a?void d("Undefined value given for Option.operate() option",this):(b=Array.prototype.slice.call(arguments),this.op.apply(this,b))},a)}])}(),function(){var a,b=angular.module("coa.core");b.factory("Options",["Class","Option",function(b,c){return a?a:(a=function(a){this.init(a)},a.prototype=new b,a.prototype.__class="coa.core.Options",a.prototype.init=function(a){if(a)for(var b in a)this[b]=new c(a[b])},a.prototype.inherit=function(b){for(var d=Object.keys(this),e=new a,f=0;f<d.length;f++)e[d[f]]=new c(angular.extend({},this[d[f]]));return e.init(b),e},a.prototype.inheritExcept=function(a,b){for(var c=this.inherit(b),d=a.split(","),e=0;e<d.length;e++)delete c[d[e]];return c},a.prototype.validate=function(a){var b;a=a||{};for(b in a){if(!this[b])return null;if(this[b].type instanceof Function){if(!this[b].type(a[b]))return null}else if(typeof a[b]!==this[b].type)return null}for(var c,d=Object.keys(this),e=0;e<d.length;e++)if(b=d[e],void 0===a[b]){if(this[b].required)return null;c||(c={},angular.extend(c,a)),c[b]=this[b]["default"]}return c?c:a},a.prototype.operate=function(a,b){var c={},d=Array.prototype.splice.call(arguments,1);d.splice(0,0,null);for(var e=Object.keys(this),f=0;f<e.length;f++)d[0]=a[e[f]],c[e[f]]=this[e[f]].operate.apply(this[e[f]],d);return c},a.prototype.test=function(a,b){var c=[],d=Array.prototype.splice.call(arguments,1);d.splice(0,0,null);for(var e=Object.keys(this),f=0;f<e.length;f++)d[0]=a[e[f]],this[e[f]].operate.apply(this[e[f]],d)||(null!==this[e[f]].text?c.push(this[e[f]].text.replace(/%o/g,d[0]).replace(/%n/g,e[f]).replace(/%v/g,d[1])):c.push(null));return c},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("Data",["Class","Options","Type",function(b,c,e){return a?a:(a=function(a,b){this._members=[],this._types={},this._options=this.optionDefinitions.validate(b),this._options||(this.optionDefinitions.validate({}),d("Invalid options",b,"for Data",this,"(using defaults instead).")),this._createMembers(a)},a.prototype=new b,a.prototype.__class="coa.data.Data",a.prototype.optionDefinitions=new c({primary_field:{text:"Default field to fill when a single atom value is given to the constructor.",type:"string"}}),a.prototype.toJSON=function(){for(var a={},b=0;b<this._members.length;b++)a[this._members[b]]=this._types[this._members[b]].toJSON(this[this._members[b]]);return a},a.prototype._createMembers=function(a){if(!(a instanceof Array))return void d("Invalid arguments",a,"for Data");for(var b=0;b<a.length;b++)for(var c=Object.keys(a[b]),e=0;e<c.length;e++)this._addMember(c[e],a[b][c[e]])},a.prototype._addMember=function(a,b){return"string"!=typeof a?void d("Invalid name for a data member",a,"with definition",b):b instanceof e?(null===b.options.label&&(b.options.label=a.code2human()),this._types[a]?void d("Trying to define member",a,"as",b,"but it has been already defined as",this._types[a],"in",this):(this._members.push(a),void(this._types[a]=b))):void d("Invalid type",b,"given for",this)},a.prototype.reset=function(){for(var a=0;a<this._members.length;a++)this[this._members[a]]=this._types[this._members[a]].copy(this._types[this._members[a]].getDefault())},a.prototype.copy=function(a){if(a.__class!==this.__class)return d("Mismatching classes when trying to copy",a,"into",this),void this.reset();for(var b=0;b<this._members.length;b++)this[this._members[b]]=this._types[this._members[b]].copy(a[this._members[b]])},a.prototype.init=function(b){var c;if(this.reset(),b instanceof a){if(b.__class!==this.__class)return void d("Cannot initialize '"+this.__class+"' object",this," from '"+b.__class+"' object",b);b=b.toJSON()}if(void 0!==b){if(!(b instanceof Object))return this._options.primary_field?(c=this._types[this._options.primary_field])?void c.set(this,this._options.primary_field,b):void d("Invalid primary field '"+this._options.primary_field+"' defined for",this):void d("Invalid initial values",b,"for",this);for(var e in b)c=this._types[e],c?c.set(this,e,b[e]):d("Invalid member name '"+e+"' in initial data",b,"for",this)}},a.prototype.getModuleAndClass=function(){return this.__class},a.prototype.getTypes=function(){return this._types},a.prototype.getType=function(a){var b=this._types[a];return b?b:null},a.prototype.isInvalid=function(){for(var a={},b=!1,c=0;c<this._members.length;c++){var d=this._types[this._members[c]].isInvalid(this[this._members[c]]);d&&(a[this._members[c]]=d,b=!0)}return b?a:!1},a.prototype.isValid=function(){return!this.isInvalid()},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("Type",["Class","Options",function(b,c){return a?a:(a=function(a){void 0===a?this.options=this.optionDefinitions.validate({})||{}:this.init(a)},a.prototype=new b,a.prototype.__class="coa.data.Type",a.prototype.optionDefinitions=new c({required:{text:"This value is required.",type:"boolean","default":!1,required:!1,op:function(a,b){return!(a&&null===b)}},"default":{"default":null,op:function(a,b){return!0}},label:{type:"string","default":null,op:function(a,b){return!0}}}),a.prototype.toString=function(){for(var a=Object.keys(this.options),c={},d=0;d<a.length;d++)null!==this.options[a[d]]&&(c[a[d]]=this.options[a[d]]);return this.__class.split(".").pop()+"("+b.prototype.toString.call(c)+")"},a.prototype.toJSON=function(a){return a},a.prototype.init=function(a){this.options={};var b=this.optionDefinitions.validate(a||{});if(!b)return void d("Invalid options",a,"for type",this);this.options=b;var c=this.convert(this.options["default"]);void 0===c&&(d("Invalid default value",this.options["default"],"for",this),c=null),this.options["default"]=c},a.prototype.convert=function(a){return a},a.prototype.getDefault=function(){return angular.copy(this.options["default"])},a.prototype.isInvalid=function(a){if(void 0===this.convert(a))return["Value has not correct type."];var b=this.optionDefinitions.test(this.options,a);return b.length?b:!1},a.prototype.isValid=function(a){return!this.isInvalid(a)},a.prototype.toJSON=function(a){return a},a.prototype.copy=function(a){return a},a.prototype.set=function(a,b,c){var e=this.convert(c);return void 0===e&&(d("Invalid value",c,"for member of type",this,"for object",a),e=this.getDefault()),a[b]=e,e},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeAny",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeAny",a.prototype.convert=function(a){return void 0===a?void 0:a},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeBool",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeBool",a.prototype.convert=function(a){return null===a||a===!1||a===!0?a:void 0},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeDict",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeDict",a.prototype.optionDefinitions=b.prototype.optionDefinitions.inheritExcept("required",{type:{text:"Incorrect value in the collection.",type:function(a){return a instanceof b},required:!0,op:function(a,b){if(null===b)return!0;for(var c=Object.keys(b),d=0;d<c.length;d++)if(!a.isValid(b[c[d]]))return!1;return!0}}}),a.prototype.optionDefinitions["default"]["default"]={},a.prototype.convert=function(a){if(null===a)return a;if(a instanceof Object){for(var b,c,d=Object.keys(a),e={},f=0;f<d.length;f++){if(b=d[f],c=this.options.type.convert(a[b]),void 0===c)return;e[b]=c}return e}},a.prototype.toJSON=function(a){if(null===a)return null;for(var b,c,d=Object.keys(a),e={},f=0;f<d.length;f++)b=d[f],c=this.options.type.toJSON(a[b]),e[b]=c;return e},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeInt",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeInt",a.prototype.convert=function(a){if(null===a)return null;if("number"==typeof a&&a===Math.round(a))return a},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeList",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeList",a.prototype.optionDefinitions=b.prototype.optionDefinitions.inherit({required:{text:"At least one is required.",type:"boolean",op:function(a,b){return a?b instanceof Array?b.length>0:!1:!0}},type:{text:"Incorrect value in the list.",type:function(a){return a instanceof b},required:!0,op:function(a,b){if(null===b)return!0;for(var c=0;c<b.length;c++)if(!a.isValid(b[c]))return!1;return!0}}}),a.prototype.optionDefinitions["default"]["default"]=[],a.prototype.convert=function(a){if(null===a)return a;if(a instanceof Array){for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=this.options.type.convert(a[c]);return b}},a.prototype.toJSON=function(a){if(null===a)return null;for(var b=[],c=0;c<a.length;c++)b.push(this.options.type.toJSON(a[c]));return b},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeObj",["Type","Data","factory",function(b,c,d){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeObj",a.prototype.optionDefinitions=b.prototype.optionDefinitions.inherit({"class":{text:"Value must belong to %o class.",type:"string",required:!0,op:function(a,b){return b instanceof c?a===b.getModuleAndClass():null===b}}}),a.prototype.convert=function(a){return void 0!==a?null===a||a instanceof c?a:a instanceof Object?d.create(this.options["class"],a):void 0:void 0},a.prototype.copy=function(a){return null===a?null:d.create(this.options["class"],a.toJSON())},a.prototype.toJSON=function(a){return null===a?null:a.toJSON()},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeOptions",["Type","TypeDict","Options",function(b,c,d){return a?a:(a=function(a){b.call(this,a)},a.prototype=new c,a.prototype.__class="coa.data.TypeOptions",a.prototype.optionDefinitions=c.prototype.optionDefinitions.inheritExcept("type",{options:{text:"Incorrect or missing option value.",type:function(a){return a instanceof d},required:!0,op:function(a,b){return null===b?!0:a.validate(b)?!0:!1}}}),a.prototype.convert=function(a){return null===a?a:a instanceof Object?(a=this.options.options.validate(a),a?a:void 0):void 0},a.prototype.toJSON=function(a){return null===a?null:angular.extend({},a)},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypePair",["Type","TypeTuple",function(b,c){if(a)return a;a=function(a){b.call(this,a)},a.prototype=new c,a.prototype.__class="coa.data.TypePair",a.prototype.optionDefinitions=c.prototype.optionDefinitions.inherit({});var d=a.prototype.optionDefinitions.types.type;return a.prototype.optionDefinitions.types.type=function(a){return d(a)&&2===a.length},a}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeStr",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeStr",a.prototype.optionDefinitions=b.prototype.optionDefinitions.inherit({pattern:{text:"Value does not have correct format.",type:function(a){return null===a||a instanceof RegExp},required:!1,"default":null,op:function(a,b){return null!==b&&a?a.test(b):!0}}}),a.prototype.convert=function(a){return null===a||"string"==typeof a?a:void 0},a)}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeTriple",["Type","TypeTuple",function(b,c){if(a)return a;a=function(a){b.call(this,a)},a.prototype=new c,a.prototype.__class="coa.data.TypeTriple",a.prototype.optionDefinitions=c.prototype.optionDefinitions.inherit({});var d=a.prototype.optionDefinitions.types.type;return a.prototype.optionDefinitions.types.type=function(a){return d(a)&&3===a.length},a}])}(),function(){var a,b=angular.module("coa.data");b.factory("TypeTuple",["Type",function(b){return a?a:(a=function(a){b.call(this,a)},a.prototype=new b,a.prototype.__class="coa.data.TypeTuple",a.prototype.optionDefinitions=b.prototype.optionDefinitions.inherit({types:{text:"Invalid tuple members.",type:function(a){if(a instanceof Array){for(var c=0;c<a.length;c++)if(!(a[c]instanceof b))return!1;return!0}return!1},required:!0,op:function(a,b){if(null===b)return!0;if(b instanceof Array){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!a[c].isValid(b[c]))return!1;return!0}return!1}}}),a.prototype.convert=function(a){return null===a?null:a instanceof Array?a:void 0},a)}])}(),function(){var a=angular.module("coa.data"),b={};a.service("factory",[function(){function a(a,c){if(1===arguments.length){var e=a.split(".");c=e.pop(),a=e.join(".")}if(b[a]&&b[a][c])return b[a][c];var f;try{f=angular.injector(["ng",a])}catch(g){return d("There is no such module than",a),null}return f.has(c)?(b[a]||(b[a]={}),b[a][c]=f.get(c),b[a][c]):(d("There is no such class than",c,"defined in the module",a),null)}function c(b,c,d){if(arguments.length<3){var e=b.split(".");d=c,c=e.pop(),b=e.join(".")}var f=a(b,c);return f?new f(d):null}return{constructor:a,create:c}}])}(),function(){var a,b=angular.module("coa.datetime");b.factory("TimeStr",["Class","Data","TypeStr","TypeBool",function(b,c,d,e){return a?a:(a=function(a){this.init(a)},a.prototype=new c([{time:new d({"default":"00:00:00",pattern:/^\d\d:\d\d:\d\d$/})},{negative:new e({"default":!1})},{overflow:new e({"default":!1})}],{primary_field:"time"}),a.prototype.__class="coa.datetime.TimeStr",a.prototype.toString=function(){return this.negative?"-"+this.time:this.time},a.now=function(){var b=new a;return b.setNow(),b},a.prototype["short"]=function(){return this.negative?this.toString().substr(0,6):this.toString().substr(0,5)},a.prototype.add=function(a,b,c){var d=this.time.split(":");c+=parseInt(d[2]),b+=Math.floor(c/60),c%=60,b+=parseInt(d[1]),a+=Math.floor(b/60),b%=60,a+=parseInt(d[0]),a>=24&&(this.overflow=!0),a%=24,this.time=("0"+a).substr(-2,2)+":"+("0"+b).substr(-2,2)+":"+("0"+c).substr(-2,2)},a.prototype.addSeconds=function(b){if(b>0)this.add(0,0,b);else{var c=new a("00:00:00"),d=this.seconds()+b;0>d?(c.addSeconds(-d),this.time=c.time,this.negative=!0):(c.addSeconds(d),this.time=c.time)}},a.prototype.setNow=function(){this.time=(new Date).toJSON().substr(11,8);var a=-(new Date).getTimezoneOffset()/60;a>0&&this.add(a,0,0),0>a&&this.add(24+a,0,0)},a.prototype.notYet=function(a){return this.time.toString()<a.toString()},a.prototype.isPast=function(a){return this.time.toString()>a.toString()},a.prototype.isAlready=function(a){return this.time.toString()>=a.toString()},a.prototype.seconds=function(){var a,b,c,d=this.time.split(":");return a=parseInt(d[0]),b=parseInt(d[1]),c=parseInt(d[2]),60*a*60+60*b+c},a.prototype.diff=function(b){var c=this.seconds(),d=b.seconds(),e=new a;return d>c?(e.add(0,0,d-c),e.negative=!0):e.add(0,0,c-d),e},a)}])}(),function(){var a=angular.module("coa.input");a.directive("keyHandler",[function(){var a={32:"Space"};return{restrict:"A",link:function(b,c,e){c.bind("keypress",function(c){var f="Unknown key "+c.keyCode;c.charCode>=65&&c.charCode<=90?f=String.fromCharCode(c.charCode):c.charCode>=97&&c.charCode<=122?f=String.fromCharCode(c.charCode).toUpperCase():c.charCode>=33&&c.charCode<=47?f=String.fromCharCode(c.charCode):c.charCode>=48&&c.charCode<=57?f=String.fromCharCode(c.charCode):c.charCode in a&&(f=a[c.charCode]);var g=b.$eval(e.keyHandler);g?b.$apply(function(){g(f)}):d("Cannot find key-press handler",e.coaKeyHandler)})}}}])}();